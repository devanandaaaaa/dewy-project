{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}{{ site_name }}{% endblock %}</title>

    <!-- Fonts & Bootstrap -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Optional external stylesheet -->
    <link href="{% static 'css/style.css' %}" rel="stylesheet">

    <style>
        :root{
            --pink-600: #ff69b4;
            --pink-500: #ff85c1;
            --accent-bg: #fff5f8;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--accent-bg);
        }

        /* Header / Navbar */
        .site-header {
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }
        .navbar-brand {
            font-family: 'Playfair Display', serif;
            color: #ff1493 !important;
            font-size: 1.5rem;
        }

        .icon-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background-color: #fff0f5;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.12);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .icon-btn img{ display:block; max-width:24px; }
        .icon-btn:hover { transform: scale(1.08); box-shadow: 0 6px 16px rgba(0,0,0,0.15); }

        form.search-form { position: relative; }
        form.search-form .form-control {
            border-radius: 50px;
            padding-left: 20px;
            padding-right: 56px;
        }
        form.search-form .form-control:focus {
            box-shadow: 0 6px 20px rgba(255, 105, 180, 0.15);
            border-color: var(--pink-600);
        }
        .search-btn {
            position: absolute;
            right: 6px;
            top: 50%;
            transform: translateY(-50%);
            border-radius: 40px;
            padding: 0.375rem .9rem;
            background: var(--pink-600);
            color: #fff;
            border: none;
            box-shadow: 0 4px 10px rgba(0,0,0,0.12);
        }

        /* Hero */
        .hero-banner {
            position: relative;
            background: url("{% static 'images/hero-bg.jpg' %}") center/cover no-repeat;
            height: 68vh;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            overflow: hidden;
            margin: 20px auto;
            max-width: 1200px;
        }
        .hero-overlay { position:absolute; inset:0; background: rgba(255,20,147,0.18); }
        .hero-content {
            position: relative; z-index: 2; text-align:center; color: #fff;
            padding: 20px;
        }
        .hero-content h1 { font-family: 'Playfair Display', serif; font-size: 3rem; margin-bottom: .5rem; }
        .hero-content p { font-size: 1.1rem; margin-bottom: 1rem; }

        /* Category carousel */
        .category-wrapper {
            max-width: 1200px;
            margin: -45px auto 0;
            position: relative;
            z-index: 20;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
        }
        .category-section {
            display:flex;
            overflow-x:auto;
            gap: 14px;
            padding: 12px;
            background: transparent;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
        }
        .category-section::-webkit-scrollbar { display: none; }
        .category-card {
            flex:0 0 auto;
            background: #fff0f5;
            width: 120px;
            border-radius: 12px;
            text-align:center;
            padding: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,.08);
            transition: transform .18s ease, box-shadow .18s ease, background .18s ease;
            text-decoration: none;
            color: inherit;
        }
        .category-card img{ width:60px; height:60px; object-fit:cover; margin-bottom:6px; border-radius:10px; }
        .category-card:hover{ transform: translateY(-6px); background: #ffe6f0; box-shadow: 0 8px 22px rgba(0,0,0,.12); }

        .scroll-btn {
            background: var(--pink-600);
            border: none;
            color: white;
            font-size: 20px;
            padding: 8px 12px;
            cursor: pointer;
            border-radius: 50%;
            box-shadow: 0 4px 10px rgba(0,0,0,0.12);
        }
        .scroll-btn:active{ transform: scale(.98); }

        /* Products grid */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-top: 18px;
        }
        .product-card {
            background: white;
            border-radius: 14px;
            padding: 12px;
            text-align: center;
            box-shadow: 0 4px 14px rgba(0,0,0,0.06);
            transition: transform .2s ease, box-shadow .2s ease;
        }
        .product-card img {
            width:100%;
            max-height:220px;
            object-fit:contain;
            border-radius:10px;
        }
        .product-card h5{ margin-top:10px; font-size:1rem; font-weight:600; }
        .product-card p.price{ color: #6c6c6c; margin:6px 0 0; }

        /* Partner / footer styles */
        .partner-section { padding: 22px 0; display:flex; justify-content:center; gap: 30px; flex-wrap:wrap; align-items:center; }
        .chatbot-icon {
            position: fixed; bottom: 20px; right: 20px; width: 60px; height: 60px;
            background: var(--pink-600); border-radius: 50%; display:flex; justify-content:center; align-items:center;
            box-shadow: 0 8px 22px rgba(0,0,0,0.18); transition: transform .18s;
        }
        .chatbot-icon img{ width:30px; }

        footer {
            background: white;
            padding: 36px 20px;
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 18px;
            box-shadow: 0 -2px 8px rgba(0,0,0,0.05);
            margin-top: 30px;
        }
        footer .footer-col { flex:1; min-width: 200px; }
        footer a{ color: inherit; text-decoration: none; }
        @media (max-width:768px){
            .hero-content h1{ font-size:2rem; }
            .category-wrapper{ margin: -30px 8px 0; }
        }
    </style>
</head>

<body class="d-flex flex-column min-vh-100">
    <!-- Header -->
    <header class="site-header sticky-top">
        <div class="container d-flex align-items-center justify-content-between py-3 flex-wrap">
            <a href="{% url 'store:product_list' %}" class="navbar-brand">{{ site_name }}</a>

            <!-- Search (center) -->
            <form class="search-form d-flex flex-grow-1 mx-3" method="get" action="{% url 'store:product_list' %}">
                <input class="form-control" type="search" name="q" placeholder="Search products..." value="{{ request.GET.q|default:'' }}" aria-label="Search products">
                <button class="search-btn" type="submit" aria-label="Search">üîç</button>
            </form>

            <!-- Right icons -->
            <div class="d-flex align-items-center gap-2">
                <a href="{% url 'store:product_list' %}" class="icon-btn" title="Home"><img src="{% static 'images/homeicon.png' %}" alt="home"></a>
                <a href="{% url 'store:offers' %}" class="icon-btn" title="Offers"><img src="{% static 'images/offericon.png' %}" alt="offers"></a>

                {% if user.is_authenticated %}
                <div class="dropdown">
                    <a href="#" class="icon-btn dropdown-toggle" id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false" title="Account">
                        <img src="{% static 'images/usericon.png.jpeg' %}" alt="user">
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                        <li class="dropdown-item-text">Hello, <strong>{{ user.username }}</strong></li>
                        <li><a class="dropdown-item" href="{% url 'accounts:profile' %}">Profile</a></li>
                        <li><a class="dropdown-item" href="{% url 'accounts:logout' %}">Logout</a></li>
                    </ul>
                </div>
                {% else %}
                <a href="{% url 'accounts:login' %}" class="icon-btn" title="Login"><img src="{% static 'images/loginicon.jpeg' %}" alt="login"></a>
                <a href="{% url 'accounts:register' %}" class="icon-btn" title="Register"><img src="{% static 'images/registericon.jpeg' %}" alt="register"></a>
                {% endif %}

                <a href="{% url 'cart:view_cart' %}" class="icon-btn position-relative" title="Cart">
                    <img src="{% static 'images/carticon.jpeg' %}" alt="cart">
                    {% if cart_item_count %}
                    <span class="badge bg-danger position-absolute top-0 start-100 translate-middle">{{ cart_item_count }}</span>
                    {% endif %}
                </a>
            </div>
        </div>
    </header>

    <!-- Hero -->
    <section class="hero-banner mx-auto">
        <div class="hero-overlay"></div>
        <div class="hero-content">
            <h1>Glow Without Limits</h1>
            <p>Luxury skincare, crafted to enhance your natural beauty.</p>
            <a href="{% url 'store:product_list' %}" class="btn" style="background:var(--pink-600); color:#fff; border-radius:40px; padding:.6rem 1.1rem;">Explore Products</a>
        </div>
    </section>

    <!-- Category carousel with scroll buttons -->
    <div class="category-wrapper">
        <div class="container d-flex align-items-center justify-content-center">
            <button class="scroll-btn me-2" onclick="scrollCategories(-300)" aria-label="Scroll left">&#10094;</button>
            <div class="category-section" id="categorySection" role="list">
                {% for category in categories %}
                <a href="{% url 'store:product_list' %}?category={{ category.slug }}" class="category-card" role="listitem" aria-label="{{ category.name }}">
                    <img src="{% if category.image %}{{ category.image.url }}{% else %}{% static 'images/placeholder.png' %}{% endif %}" alt="{{ category.name }}">
                    <div class="small mt-1">{{ category.name }}</div>
                </a>
                {% endfor %}
                {% if categories|length == 0 %}
                <div class="text-muted small">No categories available.</div>
                {% endif %}
            </div>
            <button class="scroll-btn ms-2" onclick="scrollCategories(300)" aria-label="Scroll right">&#10095;</button>
        </div>
    </div>

    <!-- Main content area -->
    <main class="container my-5 flex-fill">
        <!-- Messages -->
        {% if messages %}
        <div class="mb-3">
            {% for msg in messages %}
            <div class="alert alert-{{ msg.tags }}">{{ msg }}</div>
            {% endfor %}
        </div>
        {% endif %}

        {# Products section appears if `products` is provided in the context #}
        {% if products %}
        <section id="products" class="mb-4">
            <h2 class="mb-4 text-center">Our Products</h2>
            <div class="products-grid">
                {% for product in products %}
                <div class="product-card">
                    <a href="{% url 'store:product_detail' product.id %}" class="text-decoration-none text-dark">
                        {% if product.image %}
                        <img src="{{ product.image.url }}" alt="{{ product.name }}">
                        {% else %}
                        <img src="{% static 'images/placeholder.png' %}" alt="{{ product.name }}">
                        {% endif %}
                        <h5 class="mt-2">{{ product.name }}</h5>
                    </a>
                    <p class="price">‚Çπ{{ product.price }}</p>
                </div>
                {% empty %}
                <p class="text-center">No products available.</p>
                {% endfor %}
            </div>
        </section>
        {% endif %}

        <!-- Page-specific content -->
        {% block content %}{% endblock %}
    </main>

    <!-- Chatbot quick link -->
    <a href="{% url 'chatbot:chatbot_home' %}" class="chatbot-icon" title="Chat with us">
        <img src="{% static 'images/chatbot.jpeg' %}" alt="chatbot">
    </a>

    <!-- Footer -->
    <footer class="container">
        <div class="footer-col">
            <h5>Quick Links</h5>
            <ul class="list-unstyled">
                <li><a href="{% url 'store:product_list' %}">Products</a></li>
                <li><a href="{% url 'store:offers' %}">Offers</a></li>
                <li><a href="{% url 'accounts:profile' %}">Profile</a></li>
            </ul>
        </div>
        <div class="footer-col">
            <h5>Follow Us</h5>
            <a href="#" aria-label="Facebook"><img src="{% static 'images/facebook.jpeg' %}" width="30" alt="facebook"></a>
            <a href="#" aria-label="Instagram"><img src="{% static 'images/instagram.jpeg' %}" width="30" alt="instagram"></a>
            <a href="#" aria-label="Twitter"><img src="{% static 'images/twitter.png' %}" width="30" alt="twitter"></a>
        </div>
        <div class="footer-col">
            <h5>Newsletter</h5>
            <form method="post" action="{% url 'newsletter:subscribe' %}">
                {% csrf_token %}
                <input type="email" name="email" class="form-control mb-2" placeholder="Your email" required>
                <button class="btn" style="background:var(--pink-600); color:#fff; width:100%; border-radius:8px;">Subscribe</button>
            </form>
        </div>

        <div style="width:100%; text-align:center; margin-top:14px;">
            <small>&copy; {{ site_name }} {% now "Y" % }. All rights reserved.</small>
        </div>
    </footer>

    <!-- Scripts -->
    <script>
        function scrollCategories(amount){
            const el = document.getElementById('categorySection');
            if(!el) return;
            el.scrollBy({ left: amount, behavior: 'smooth' });
        }

        // Optional: keyboard accessible scroll
        document.addEventListener('keydown', function(e){
            if(e.key === 'ArrowLeft') scrollCategories(-200);
            if(e.key === 'ArrowRight') scrollCategories(200);
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>


